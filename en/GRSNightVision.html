<!--
title: GRS: Night Vision
description: 
published: true
date: 2026-01-27T22:07:32.539Z
tags: 
editor: code
dateCreated: 2026-01-08T16:21:42.520Z
-->

# ğŸ”¦ SHS Night Vision & Lights - Light Identifier Setup Guide

## ğŸ“‘ Table of Contents

- [Overview](#overview)
- [Quick Start](#quick-start)
- [Detailed Setup](#detailed-setup)
- [Naming Convention](#naming-convention)
- [Multiple Lights Per Character](#multiple-lights-per-character)
- [Troubleshooting](#troubleshooting)
- [Network Architecture](#network-architecture)
- [Join-In-Progress (JIP)](#join-in-progress-jip)
- [Best Practices](#best-practices)
- [Reference: Component Fields](#reference-component-fields)

---

## Overview

The **Light Identifier** system allows multiple independent lights on a character to sync correctly in multiplayer. Each light component needs a unique identifier string that is consistent across all clients.

> **Why is this needed?**  
> In multiplayer, attachment entities (like weapon lights) can have different internal IDs on different machines. The Light Identifier provides a reliable, human-readable way to match lights across the network.

---

## Quick Start

1. Open your prefab containing `SHS_NVL_LightsComponent`
2. Find the **Light Identifier** field
3. Enter a unique name (e.g., `"HelmetLight"`, `"WeaponPEQ15"`)
4. Save the prefab
5. Repeat for each light prefab

---

## Detailed Setup

### Step 1: Open Your Light Prefab

Navigate to your prefab that has the `SHS_NVL_LightsComponent` attached. This could be:

- A helmet attachment
- A weapon rail accessory (PEQ-15, flashlight, etc.)
- A vest/plate carrier light
- Any other equipment with lights

### Step 2: Locate the Light Identifier Field

In the `SHS_NVL_LightsComponent`, you'll find:

| Field | Description |
|-------|-------------|
| **Light Identifier** âš ï¸ Required | Unique string ID for network synchronization |
| Light Sources | Array of flashlight/IR configurations |
| Toggle Action | Input action for flashlight |
| Toggle IR Action | Input action for IR |

### Step 3: Set a Unique Identifier

Enter a descriptive, unique identifier string:

```
Examples:
â”œâ”€â”€ Helmet Lights
â”‚   â”œâ”€â”€ "HelmetLight"
â”‚   â”œâ”€â”€ "HelmetLight_Left"
â”‚   â””â”€â”€ "HelmetLight_Right"
â”‚
â”œâ”€â”€ Weapon Accessories  
â”‚   â”œâ”€â”€ "WeaponPEQ15"
â”‚   â”œâ”€â”€ "WeaponPEQ2"
â”‚   â”œâ”€â”€ "WeaponM3X"
â”‚   â”œâ”€â”€ "WeaponSureFire"
â”‚   â””â”€â”€ "RailFlashlight"
â”‚
â”œâ”€â”€ Body/Vest Lights
â”‚   â”œâ”€â”€ "VestIRStrobe"
â”‚   â”œâ”€â”€ "BackpackLight"
â”‚   â””â”€â”€ "ChestLight"
â”‚
â””â”€â”€ Vehicle Mounted
    â”œâ”€â”€ "VehicleSpotlight"
    â””â”€â”€ "VehicleIR"
```

### Step 4: Save and Test

1. Save your prefab
2. Launch a multiplayer session (host + client)
3. Toggle lights on one player
4. Verify the other player sees the correct light toggle

---

## Naming Convention

Use a consistent naming scheme across your mod:

```
[Location][Type][Variant]

Examples:
- HelmetFlashlight
- HelmetIRBeacon
- WeaponPEQ15_Primary
- WeaponPEQ15_Secondary
- VestStrobe_Front
- VestStrobe_Back
```

### Rules

| Rule | âœ… Good | âŒ Bad |
|------|---------|--------|
| No spaces | `WeaponLight` | `Weapon Light` |
| No special characters | `PEQ15_Rail` | `PEQ-15 (Rail)` |
| Descriptive | `HelmetMountedNVLight` | `Light1` |
| Unique per character | Different IDs for each | Same ID for multiple |

---

## Multiple Lights Per Character

When a character can have multiple lights simultaneously, each **must** have a unique identifier:

### Example: Soldier with Helmet + Weapon Light

**Helmet Light Prefab:**
```
Light Identifier: "HelmetLight"
```

**Weapon PEQ-15 Prefab:**
```
Light Identifier: "WeaponPEQ15"
```

### Example: Dual Weapon Lights

If a weapon can mount two lights:

**Primary Rail Light:**
```
Light Identifier: "WeaponLight_Primary"
```

**Secondary Rail Light:**
```
Light Identifier: "WeaponLight_Secondary"
```

---

## Troubleshooting

### âŒ Light not syncing to other players

1. **Check identifier is set** - Empty identifier = no network sync
2. **Check identifier is unique** - Duplicate IDs cause conflicts
3. **Check logs** - Look for `[SHS_Network]` messages:

```
[SHS_Network] GetLightIdentifier - ID: WeaponPEQ15
[SHS_Network] FindLightsComponentByIdentifier - Looking for 'WeaponPEQ15'
```

### âŒ "Component NOT FOUND" in logs

```
[SHS_Network] CLIENT - Component NOT FOUND for 'WeaponPEQ15'
```

This means:
- The identifier doesn't match any light on that character
- The light component hasn't initialized yet (rare timing issue)
- The prefab identifier was changed but not on all clients

> ğŸ’¡ **Solution:** Verify the identifier string is identical in the prefab on both server and client builds.

### âŒ Lights affecting wrong component

If toggling one light affects a different one:
- Two lights have the same identifier
- Change one to be unique

### âš ï¸ Fallback Behavior

If no identifier is set, the system falls back to using the **entity name**. This is less reliable and not recommended for production use.

---

## Network Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT A (Owner)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Player presses flashlight key                            â”‚   â”‚
â”‚  â”‚ â†’ LightsComponent.RequestToggleFlashlight()              â”‚   â”‚
â”‚  â”‚ â†’ NetworkComponent.AskToggleFlashlight(lights)           â”‚   â”‚
â”‚  â”‚ â†’ Gets identifier: "WeaponPEQ15"                         â”‚   â”‚
â”‚  â”‚ â†’ Applies state locally                                  â”‚   â”‚
â”‚  â”‚ â†’ Sends RPC: Rpc_AskSetFlashlight("WeaponPEQ15", true)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SERVER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Receives: Rpc_AskSetFlashlight("WeaponPEQ15", true)      â”‚   â”‚
â”‚  â”‚ â†’ Stores state in map: m_mFlashlightStates["WeaponPEQ15"]â”‚   â”‚
â”‚  â”‚ â†’ Finds component by identifier                          â”‚   â”‚
â”‚  â”‚ â†’ Applies state on server                                â”‚   â”‚
â”‚  â”‚ â†’ Broadcasts: Rpc_DoSetFlashlight("WeaponPEQ15", true)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLIENT B (Other Player)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Receives: Rpc_DoSetFlashlight("WeaponPEQ15", true)       â”‚   â”‚
â”‚  â”‚ â†’ Searches character for LightsComponent                 â”‚   â”‚
â”‚  â”‚ â†’ Matches identifier: "WeaponPEQ15"                      â”‚   â”‚
â”‚  â”‚ â†’ Applies flashlight state to correct component          â”‚   â”‚
â”‚  â”‚ â†’ Light is now visible to Client B                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Join-In-Progress (JIP)

The identifier system also handles players joining mid-game:

1. New player connects
2. Server sends all stored light states via `RplSave`
3. States are keyed by identifier string
4. Client receives states in `RplLoad`
5. Client matches identifiers to local components
6. All lights restore to correct state

---

## Best Practices

### âœ… DO

- Set identifiers in the prefab (not at runtime)
- Use descriptive, consistent naming
- Test with 2+ players before release
- Keep identifiers short but meaningful

### âŒ DON'T

- Leave identifier empty for networked lights
- Use the same identifier for different light types
- Change identifiers after release (breaks saved states)
- Use runtime-generated identifiers

---

## Reference: Component Fields

### SHS_NVL_LightsComponent

| Field | Type | Description |
|-------|------|-------------|
| `Light Identifier` | string | âš ï¸ **Required for MP** - Unique network ID |
| `Light Sources` | array | Flashlight/IR light configurations |
| `Toggle Action` | string | Input action name for flashlight |
| `Toggle IR Action` | string | Input action name for IR |
| `Brightness Up Action` | string | Input for increasing brightness |
| `Brightness Down Action` | string | Input for decreasing brightness |
| `Default Flashlight Brightness` | float | Starting brightness (LV) |
| `Default IR Brightness` | float | Starting IR brightness (LV) |

---

## Version History

| Version | Changes |
|---------|---------|
| 1.0 | Initial identifier-based networking system |

---

## Support

If you encounter issues:

1. Enable logging and check for `[SHS_Network]` and `[SHS_Lights]` messages
2. Verify identifier strings match exactly (case-sensitive)
3. Test in a clean multiplayer environment
4. Report issues with log files attached